

------------------------------------------------------------
------------------- Timing the networks --------------------
------------------------------------------------------------

Layer        Theoretical       Observed      Accounts for  
------------------------------------------------------------
Conv1           5.2679          0.5773     0.27945 / 0.71595
Conv2           2.7885          0.5450     0.57816 / 0.23033
Lin1            4.9659          0.8315     0.11600 / 0.03130
Lin2            5.5037          0.8345     0.02436 / 0.01109
Lin3            1.0000          1.0729     0.00203 / 0.01133
------------------------------------------------------------
Total           3.4459          0.5799     

The number of parameters:
Original: 61706    Compressed:  13347    Ratio:  0.216
Based on 1000 samples and 100 observations pushed forward
FLOPS orig:  tensor([231280, 478500,  96000,  20160,   1680])
FLOPS dcmp:  tensor([ 43904, 171596,  19332,   3663,   1680])
FLOPs dcmp 2:  tensor([ 38416,   5488,  34496, 119400,  17700,  14382,    630,   4320,   2151,
          1512,   1680])
Full time orig 9.896200410999985 +- 1.379831712057528 and compressed 17.064781807000053 +- 0.3653763380726455
Time orig:  [7.08515374 2.27939852 0.30971882 0.10975658 0.11217275] [1.34655591 0.07427949 0.06679804 0.01410358 0.00566251]
Layer time dcmp:  [3.42191081 8.85183221 1.40094593 0.87600494 1.90551272 0.20273437
 0.05710349 0.11266583 0.05662342 0.07489777 0.10455033] [0.10326844 0.17883655 0.08964454 0.04305735 0.03068376 0.00894498
 0.0036046  0.0063202  0.00343707 0.00461337 0.00413858]
Layer time dcmp comp:  [12.27374302  4.18246359  0.37250369  0.13152118  0.10455033] [0.10326844 0.17883655 0.08964454 0.04305735 0.03068376 0.00894498
 0.0036046  0.0063202  0.00343707 0.00461337 0.00413858]


------------------------------------------------------------
---------------- Timing the VGG-16 network -----------------
------------------------------------------------------------

Time for the VGG-16 network was 0.3856044411659241 +- 0.012621510773897171 second, while the decomposed version took 0.19028829038143158 +- 0.003078932873904705 seconds
Theoretical speed-up is 5.5527 while the observed speed-up is 2.03
